clear all
clc
close all
% movielens数据
[m,n] = meshgrid(100:100:500,200:200:1000);
rmse = [0.9369902	0.93572164	0.93729862	0.93610461	0.93803715
0.93925691	0.93538983	0.93582966	0.93193645	0.93594327
0.93694988	0.93336769	0.93412279	0.93637205	0.93487216
0.9349743	0.93575258	0.93266009	0.93263671	0.93316647
0.93520637	0.93112539	0.93377294	0.93387742	0.93228895
];
figure(1)
surf(m,n,rmse)  
zlim([min(min(rmse)),max(max(rmse))])
xlabel('m_{1}','FontName','Times New Roman','FontSize',24);
ylabel('n_{1}','FontName','Times New Roman','FontSize',24);
zlabel('RMSE','FontName','Times New Roman','FontSize',24);
colorbar
set(gca,'FontName','Times New Roman','FontSize',24);
set(gcf,'Position',[1,1,1500,1000]);



% 豆瓣数据集
[m,n] = meshgrid(400:400:2000,400:400:2000);
rmse = [0.77449042	0.77489035	0.77519112	0.77546032	0.77649949
0.77561152	0.77533125	0.77481832	0.7755497	0.77540054
0.7755579	0.775516	0.77554889	0.77574997	0.77580664
0.77566662	0.77529371	0.77464004	0.77572323	0.77632914
0.77455813	0.77445021	0.77568481	0.775669	0.77442548
]
figure(2)
surf(m,n,rmse)  
zlim([min(min(rmse)),max(max(rmse))])
xlabel('m_{1}','FontName','Times New Roman','FontSize',24);
ylabel('n_{1}','FontName','Times New Roman','FontSize',24);
zlabel('RMSE','FontName','Times New Roman','FontSize',24);
colorbar
set(gca,'FontName','Times New Roman','FontSize',24);
set(gcf,'Position',[1,1,1500,1000]);

% douban在不同m1上的表现
m1 = 400:400:2000;

douban_tanh = [0.77409598	0.77432834	0.77173556	0.77603196	0.77525007];
douban_linear = [0.77566662	0.77529371	0.77464004	0.77572323	0.77632914];
figure(3)
plot(m1,douban_tanh,'--or',...
      'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','r',...
       'MarkerFaceColor','r')
   hold on 
plot(m1,douban_linear,'-ob',...
      'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','b',...
       'MarkerFaceColor','b')
legend('DMF','NL-DMF')
xlabel('m_{1}','FontName','Times New Roman','FontSize',24);
ylabel('RMSE','FontName','Times New Roman','FontSize',24);
set(gca,'FontName','Times New Roman','FontSize',24);
set(gcf,'Position',[1,1,1500,1000]);

% douban在不同n1上的表现
n1 = 400:400:2000;
douban_tanh = [0.77334002
0.77199311
0.77422438
0.77432834
0.77445847];
douban_linear = [0.77489035
0.77533125
0.775516
0.77529371
0.77445021];
figure(4)
plot(n1,douban_tanh,'--or',...
      'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','r',...
       'MarkerFaceColor','r')
   hold on 
plot(n1,douban_linear,'-ob',...
      'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','b',...
       'MarkerFaceColor','b')
legend('DMF','NL-DMF')
xlabel('n_{1}','FontName','Times New Roman','FontSize',24);
ylabel('RMSE','FontName','Times New Roman','FontSize',24);
set(gca,'FontName','Times New Roman','FontSize',24);
set(gcf,'Position',[1,1,1500,1000]);

% movielens在不同m1上的表现
m1 = 100:100:500;
douban_tanh = [0.93134415	0.92915765	0.9310692	0.93221995	0.93568724
];
douban_linear = [0.9369902	0.93572164	0.93729862	0.93610461	0.93803715
];
figure(5)
plot(m1,douban_tanh,'--or',...
      'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','r',...
       'MarkerFaceColor','r')
   hold on 
plot(m1,douban_linear,'-ob',...
      'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','b',...
       'MarkerFaceColor','b')
legend('DMF','NL-DMF')
xlabel('m_{1}','FontName','Times New Roman','FontSize',24);
ylabel('RMSE','FontName','Times New Roman','FontSize',24);
set(gca,'FontName','Times New Roman','FontSize',24);
set(gcf,'Position',[1,1,1500,1000]);

% movielens在不同n1上的表现
n1 = 200:200:1000;
douban_tanh = [0.93134415
0.92707875
0.93016205
0.92472035
0.92872972
];
douban_linear = [0.9369902
0.93925691
0.93694988
0.9349743
0.93520637
];
figure(6)
plot(n1,douban_tanh,'--or',...
      'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','r',...
       'MarkerFaceColor','r')
   hold on 
plot(n1,douban_linear,'-ob',...
      'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','b',...
       'MarkerFaceColor','b')
legend('DMF','NL-DMF')
xlabel('n_{1}','FontName','Times New Roman','FontSize',24);
ylabel('RMSE','FontName','Times New Roman','FontSize',24);
set(gca,'FontName','Times New Roman','FontSize',24);
set(gcf,'Position',[1,1,1500,1000]);







V2 = [1.1634861066491111, 1.3617963479677535, 1.0867997783004471, 1.0527569857955665, 1.0607644226756479, 1.0480950056671539, 1.0406007977049823, 1.0362124478221728, 1.0323222152697522, 1.0291832157758094, 1.0266241457448781, 1.0244615525573935, 1.0226132810225514, 1.0210149344492847, 1.0196170653552676, 1.0183833816786847, 1.0172859160813843, 1.0163027484468936, 1.0154164940936752, 1.014613164766488, 1.0138813709882935, 1.0132117420572937, 1.0125964942713692, 1.0120291061950637, 1.0115040709068988, 1.0110167046459848, 1.0105629974705588, 1.0101394955306715, 1.0097432073717041, 1.0093715286811089, 1.0090221813151001, 1.0086931635010268, 1.0083827089097535, 1.0080892528371765, 1.0078114040976103, 1.0075479215212866, 1.0072976941850484, 1.0070597246927142, 1.0068331149744192, 1.0066170541809947, 1.0064108083143797, 1.0062137112960405, 1.0060251572438201, 1.0058445937759679, 1.0056715161891228, 1.0055054623821558, 1.0053460084192474, 1.005192764641387, 1.0050453722467598, 1.0049035002707463, 1.0047668429099752, 1.0046351171487198, 1.0045080606522097, 1.0043854298930459, 1.0042669984795971, 1.0041525556589048, 1.0040419049720632, 1.0039348630459461, 1.0038312585074862, 1.003730931006007, 1.0036337303292928, 1.0035395156016871, 1.0034481545558243, 1.0033595228712648, 1.0032735035736067, 1.0031899864882732, 1.0031088677435711, 1.0030300493171993, 1.0029534386205803, 1.002878948116662, 1.0028064949681164, 1.0027360007135564, 1.0026673909699704, 1.0026005951599382, 1.0025355462618997, 1.0024721805811092, 1.0024104375386746, 1.0023502594764602, 1.0022915914761559, 1.0022343811911092, 1.002178578689608, 1.0021241363086573, 1.0020710085178444, 1.0020191517932182, 1.0019685245008105, 1.0019190867889294, 1.001870800488095, 1.0018236290177369, 1.0017775372991182, 1.0017324916742085, 1.0016884598301954, 1.0016454107291157, 1.0016033145419805, 1.001562142586943, 1.001521867271375, 1.0014824620378457, 1.001443901313914, 1.0014061604654791, 1.0013692157533487, 1.0013330442927038, 1.0012976240151481, 1.0012629336330872, 1.0012289526061573]
V1 = [0.92777415102520333, 1.3915809055996138, 1.347641129729851, 1.2660643815210766, 1.2177348448931564, 1.1623695148750088, 1.1221109210395814, 1.0936399226764308, 1.0719693962902777, 1.0554454714265129, 1.0426040094395397, 1.0323701965413283, 1.0240598020530998, 1.0172001416387397, 1.0114594921965139, 1.0065983599250738, 1.0024372776284047, 0.99884052397873468, 0.99570561591651141, 0.99295380236463349, 0.99052247922322922, 0.98836046674585165, 0.9864253849909983, 0.98468256342515992, 0.98310403856741946, 0.98166704974922447, 0.98035288413300359, 0.97914626487411893, 0.97803472580251594, 0.97700779484210476, 0.97605642212119159, 0.97517287292838295, 0.97435070393268175, 0.97358455535999211, 0.97286981880183665, 0.97220232455047129, 0.97157821960212354, 0.97099401073351943, 0.97044654934855012, 0.96993290750581673, 0.96945030582605973, 0.96899616832780422, 0.96856820126800602, 0.96816440922341584, 0.96778304929319769, 0.96742255242235475, 0.96708144347459979, 0.96675828435336442, 0.96645166094730761, 0.96616022527906764, 0.96588276824592134, 0.96561826535289419, 0.96536586832141713, 0.96512486153943056, 0.96489461070992522, 0.96467452619144778, 0.96446405333180885, 0.96426268073804244, 0.96406994767831256, 0.96388544399142551, 0.96370880615131338, 0.96353970909250575, 0.96337785000395204, 0.96322292916732988, 0.96307463851923647, 0.9629326601263557, 0.96279666936279418, 0.96266633929759338, 0.96254134556451809, 0.96242137209197998, 0.96230611984639158, 0.96219531970849104, 0.96208874417066104, 0.96198620957807779, 0.96188756727761771, 0.96179268959300701, 0.96170145708314114, 0.96161374960162749, 0.96152944111840966, 0.9614483987529211, 0.96137048667925096, 0.96129557323498482, 0.9612235372444814, 0.96115427066062797, 0.96108767788952065, 0.96102367341132267, 0.96096217811194973, 0.96090311437453735, 0.96084640136489052, 0.96079195265064166, 0.96073967703912655, 0.96068948178050562, 0.96064127655127296, 0.96059497682160788, 0.960550505750982, 0.96050779438790368, 0.9604667804120669, 0.96042740585491271, 0.96038961442525628, 0.96035334926944871, 0.96031855186781157, 0.96028516224772165, 0.96025312014133368]
U2 = [1.0945634184780599, 1.0949052518795306, 0.96844972027265941, 1.0078376190372793, 1.0122913761068026, 1.0054324828802159, 1.004925958385479, 1.0042465333699138, 1.0033275973640619, 1.0026762536301463, 1.0021325590072157, 1.0016622610786072, 1.0012613002050625, 1.0009147043268867, 1.0006122501335784, 1.0003465639195681, 1.0001115893652492, 0.99990250885435361, 0.99971544893429631, 0.99954724908291448, 0.99939531139248283, 0.99925748303594797, 0.99913196614664046, 0.99901724882121778, 0.99891205133212857, 0.99881528388966767, 0.99872601323532584, 0.99864343599184779, 0.99856685724070482, 0.99849567319247146, 0.99842935705944402, 0.99836744742772132, 0.9983095386251285, 0.99825527272160763, 0.99820433286480548, 0.9981564376957569, 0.99811133662902207, 0.99806880584253665, 0.99802864487453757, 0.99799067373186734, 0.99795473041142646, 0.99792066875407959, 0.99788835658269148, 0.99785767409219372, 0.99782851245825221, 0.99780077263262879, 0.99777436429610677, 0.99774920494117214, 0.9977252190597341, 0.99770233741821701, 0.99768049641215584, 0.99765963749873177, 0.99763970670141755, 0.99762065417544687, 0.99760243382384139, 0.9975850029549671, 0.99756832197380008, 0.99755235410268539, 0.9975370651298745, 0.9975224231837363, 0.99750839852944406, 0.99749496338517418, 0.99748209175617975, 0.99746975928503556, 0.99745794311532443, 0.99744662176669752, 0.99743577502092573, 0.99742538381898771, 0.99741543016855339, 0.99740589706057403, 0.99739676839348612, 0.99738802890383671, 0.99737966410307455, 0.99737166022082124, 0.99736400415423343, 0.99735668342201866, 0.99734968612161723, 0.99734300088892724, 0.9973366168607819, 0.99733052364038011, 0.99732471126536804, 0.99731917017806848, 0.99731389119766789, 0.99730886549446618, 0.99730408456638719, 0.99729954021796652, 0.99729522454202402, 0.99729112990386404, 0.99728724892734422, 0.99728357448203386, 0.99728009967111753, 0.99727681782019173, 0.99727372246718804, 0.9972708073534664, 0.99726806641589971, 0.99726549377976592, 0.99726308375235662, 0.99726083081725081, 0.99725872962913087, 0.99725677500892307, 0.99725496193904362, 0.99725328555868431, 0.99725174115919268]
U1 = [1.4916009844385276, 1.233489522840814, 1.0597010927602786, 1.0662981945615075, 1.0573710397070617, 1.0449874058812452, 1.0390172167447056, 1.0343698841420985, 1.0305130821885748, 1.0274714783064469, 1.0249708504300001, 1.0228707824048437, 1.0210856477479846, 1.0195474156284112, 1.0182067266691972, 1.0170268417682922, 1.0159795300486623, 1.0150428529524771, 1.014199511792087, 1.0134356772632371, 1.0127401629863804, 1.012103821622178, 1.0115190984049578, 1.0109796969805016, 1.0104803258702622, 1.0100165038421463, 1.0095844088657713, 1.0091807597147988, 1.0088027223258844, 1.0084478351246666, 1.0081139489857018, 1.0077991785492488, 1.0075018624407739, 1.0072205305484179, 1.0069538769388182, 1.0067007372988606, 1.0064600700233732, 1.0062309402703602, 1.0060125064675196, 1.0058040088494038, 1.0056047596666382, 1.005414134774903, 1.0052315663808429, 1.0050565367687654, 1.0048885728571353, 1.0047272414576867, 1.0045721451327159, 1.0044229185629294, 1.0042792253501591, 1.0041407551905617, 1.0040072213681568, 1.0038783585320554, 1.003753920724632, 1.0036336796277456, 1.0035174229981867, 1.0034049532675335, 1.0032960862841109, 1.0031906501790493, 1.003088484343126, 1.0029894385031788, 1.0028933718872459, 1.0028001524687908, 1.0027096562825251, 1.0026217668047921, 1.0025363743906468, 1.002453375760491, 1.0023726735312204, 1.0022941757881876, 1.0022177956944731, 1.0021434511335723, 1.0020710643811963, 1.0020005618025529, 1.0019318735730891, 1.001864933421859, 1.0017996783961491, 1.0017360486449245, 1.0016739872186462, 1.0016134398839394, 1.0015543549524382, 1.0014966831231054, 1.0014403773367153, 1.0013853926409475, 1.0013316860649215, 1.0012792165025408, 1.0012279446041912, 1.0011778326763512, 1.0011288445887307, 1.0010809456885008, 1.0010341027208747, 1.0009882837551811, 1.0009434581158114, 1.0008995963178255, 1.0008566700071089, 1.0008146519048204, 1.0007735157557205, 1.0007332362799677, 1.0006937891280838, 1.0006551508388759, 1.0006172988000603, 1.0005802112112889, 1.0005438670492635, 1.0005082460347161, 1.0004733286011682]
figure(6)
plot(1:length(V2),V2,'-or',...
      'LineWidth',5,...
       'MarkerSize',10',...
       'MarkerEdgeColor','r',...
       'MarkerFaceColor','r')
   hold on 
plot(1:length(V1),V1,'-ob',...
     'LineWidth',5,...
       'MarkerSize',10',...
       'MarkerEdgeColor','b',...
       'MarkerFaceColor','b')
   hold on 
   plot(1:length(U1),U1,'-om',...
       'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','m',...
       'MarkerFaceColor','m')
   hold on 
   plot(1:length(U2),U2,'-oc',...
     'LineWidth',5,...
       'MarkerSize',10,...
       'MarkerEdgeColor','c',...
       'MarkerFaceColor','c')
   hold on 
   
legend('V_{2}','V_{1}','U_{1}','U_{2}')
xlabel('Epochs','FontName','Times New Roman','FontSize',24);
ylabel('The value of Renewal factor','FontName','Times New Roman','FontSize',24);
set(gca,'FontName','Times New Roman','FontSize',24);
set(gcf,'Position',[1,1,1500,1000]);


testerror = [2.1822006278140953, 1.6482658943068953, 1.1830655298448463, 1.1541221779468716, 1.1109528902217751, 1.0686873515680797, 1.0443877768993903, 1.0266742267347979, 1.0131598555370569, 1.0028806532915171, 0.99480127074183311, 0.98830007013781629, 0.98297257026879681, 0.97853179488479791, 0.97477525011523425, 0.97155665351547205, 0.96876779081488351, 0.96632721069440564, 0.96417258141219253, 0.96225547992943572, 0.96053777543774999, 0.95898906538779627, 0.95758483045247, 0.95630508848799234, 0.95513339178631262, 0.95405606680957455, 0.9530616424499746, 0.95214042695166501, 0.95128418807705784, 0.95048589843340092, 0.949739526380183, 0.94903986255720352, 0.94838237886430399, 0.94776311897944099, 0.94717861274209769, 0.94662580483377934, 0.94610199532026296, 0.94560479306830536, 0.94513207856444204, 0.94468196983221342, 0.94425278931357526, 0.94384303391568991, 0.9434513508136062, 0.94307651979487361, 0.94271744094219045, 0.94237312515015903, 0.94204268348026465, 0.94172531219735878, 0.94142027634335268, 0.94112689840871167, 0.94084455369730302, 0.94057266813807927, 0.94031071504175678, 0.94005821109387999, 0.93981471308483033, 0.93957981529624213, 0.9393531463851108, 0.93913436555731322, 0.93892315891076794, 0.93871923625108478, 0.93852232776207978, 0.93833218068576818, 0.93814855719687729, 0.93797123383122494, 0.93780000149696363, 0.93763466503380677, 0.93747504214037147, 0.93732096218787408, 0.93717226526624098, 0.93702880121068677, 0.93689042833443648, 0.93675701206615813, 0.93662842388721568, 0.93650454072327294, 0.93638524466271156, 0.93627042277711747, 0.93615996686742164, 0.9360537731236801, 0.9359517418826071, 0.93585377769441347, 0.93575978968712104, 0.93566969192329652, 0.93558340335058154, 0.93550084712117842, 0.9354219493578606, 0.93534663774068505, 0.93527484043194919, 0.93520648569104858, 0.9351415021393753, 0.93507981933011519, 0.9350213682626457, 0.93496608168225437, 0.93491389421073845, 0.93486474241521478, 0.93481856485290471, 0.93477530205261683, 0.93473489640709539, 0.93469729202783314, 0.93466243465077059, 0.93463027162853973]
trainerror = [2.1255316970449081, 1.5660387754552108, 1.0428018649009019, 1.0183647514928107, 0.97343595687760087, 0.92748016051759385, 0.90250909503354992, 0.88469219995346304, 0.8713247713505049, 0.86141630250498913, 0.85379866411621452, 0.84778901335124501, 0.8429518627893493, 0.83898018571829214, 0.83566041941505043, 0.83284058347623702, 0.83040991874594228, 0.8282863898605578, 0.82640823687445875, 0.82472825637123115, 0.82320988005952356, 0.82182442145274004, 0.82054911291131305, 0.81936569236800194, 0.81825937309755992, 0.81721808033321508, 0.81623187842491629, 0.81529253726410467, 0.81439319926289067, 0.81352811838013284, 0.81269245358120379, 0.81188210613064282, 0.81109359169638784, 0.81032393834312322, 0.80957060346473086, 0.80883140542081033, 0.80810446742670006, 0.8073881715432828, 0.80668112057970165, 0.80598210648340485, 0.80529008435581018, 0.8046041510960652, 0.80392352758484809, 0.80324754353660233, 0.80257562442941377, 0.80190728005468825, 0.80124209428873916, 0.80057971581220355, 0.79991984974970143, 0.79926225050321098, 0.79860671592103949, 0.79795308243016194, 0.79730122061698283, 0.79665103109667612, 0.7960024407864823, 0.79535539959043822, 0.79470987730333797, 0.79406586055252248, 0.79342334976247442, 0.79278235627054416, 0.79214289974659102, 0.79150500597611062, 0.79086870493168837, 0.79023402901511808, 0.78960101145089434, 0.78896968491274044, 0.78834008044033888, 0.78771222661433804, 0.78708614891418693, 0.78646186919286987, 0.78583940523029083, 0.78521877036048249, 0.78459997319971531, 0.78398301751854871, 0.78336790227809261, 0.78275462178786559, 0.78214316589310906, 0.78153352012511823, 0.78092566583534184, 0.78031958039286586, 0.77971523749501148, 0.77911260756015721, 0.77851165812027434, 0.7779123541461137, 0.77731465830015212, 0.77671853116923006, 0.77612393153539416, 0.77553081670046331, 0.77493914283143073, 0.77434886528093971, 0.77375993886146843, 0.77317231808353115, 0.77258595737894276, 0.7720008113176795, 0.77141683480917755, 0.77083398327328267, 0.77025221277546263, 0.76967148013492359, 0.76909174301994898, 0.76851296003878744]
plot(1:length(testerror),testerror,'-or',...
      'LineWidth',5,...
       'MarkerSize',10',...
       'MarkerEdgeColor','r',...
       'MarkerFaceColor','r')
   hold on 
plot(1:length(trainerror),trainerror,'-ob',...
     'LineWidth',5,...
       'MarkerSize',10',...
       'MarkerEdgeColor','b',...
       'MarkerFaceColor','b')


   
legend('Testerror','Trainerror')
xlabel('Epochs','FontName','Times New Roman','FontSize',24);
ylabel('Error','FontName','Times New Roman','FontSize',24);
set(gca,'FontName','Times New Roman','FontSize',24);
set(gcf,'Position',[1,1,1500,1000]);